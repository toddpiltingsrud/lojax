"use strict";var lojax=lojax||{};(function(n,t){var i,u,r,e,f;t.Controller||(i={},u={},t.Controller={},t.Transitions={},r=t.Controller,t.priv=i,t.on=function(t,i,u){if(u===undefined)n(document).on(t,function(){r.executeRequest(i)});else n(document).on(t,i,function(){r.executeRequest(u)})},t.off=function(t){n(document).off(t)},t.exec=function(n){r.executeRequest(n)},t["in"]=function(n){r["in"]=n},t.out=function(n){r.out=n},t.createModal=function(u){t.closeModal();r.modal=n(u).modal({show:!0,keyboard:!0});r.modal.on("hidden.bs.modal",function(){i.hasValue(r.modal)&&(r.modal.off("hidden.bs.modal",r.onModalClose),r.modal.modal("hide"),r.modal=null)})},t.closeModal=function(){i.hasValue(r.modal)&&(n.fn.modal?r.modal.modal("hide"):n.fn.kendoWindow&&r.modal.data("kendoWindow").close())},t.events={beforeSubmit:"beforeSubmit",beforeRequest:"beforeRequest",afterRequest:"afterRequest",beforeUpdateModel:"beforeUpdateModel",afterUpdateModel:"afterUpdateModel",beforeInject:"beforeInject",afterInject:"afterInject",ajaxError:"ajaxError"},Object.getOwnPropertyNames(t.events).forEach(function(i){t[i]=function(t){if(typeof t=="function")n(document).on(lojax.events[i],t)}}),t.config={prefix:"jx-",transition:"fade-in",emptyHashAction:null},e=!1,Object.defineProperty(t.config,"navHistory",{get:function(){return e},set:function(n){e=n;n?window.addEventListener("hashchange",t.Controller.handleHash,!1):window.removeEventListener("hashchange",t.Controller.handleHash,!1);n&&t.Controller.handleHash()}}),t.select={methodOrRequest:"[data-request],[jx-request],[data-method]:not([data-trigger]),[jx-method]:not([jx-trigger])",methodWithChange:"[data-method][data-trigger*=change],[jx-method][jx-trigger*=change]",methodWithEnterOrModel:"[data-method][data-trigger*=enter],[jx-method][jx-trigger*=enter],[data-model],[jx-model]",formWithMethod:"form[data-method],form[jx-method]",model:"[data-model],[jx-model]",src:"[data-src],[jx-src]",preload:"[data-preload],[jx-preload]",jxModelAttribute:"[jx-model]",jxModel:"jx-model",inputTriggerChangeOrEnter:":input[name][jx-trigger*=change],:input[name][data-trigger*=change],:input[name][jx-trigger*=enter],:input[name][data-trigger*=enter]",panel:function(n){return"["+lojax.config.prefix+'panel="'+n+'"],[data-panel="'+n+'"]'}},n.extend(t.Controller,{init:function(){var r=this;this.div=null;this.modal=null;this.currentTransition=null;this.currentPanel=null;this.cache={};this.isControl=!1;n(function(){r.div=n('<div style="display:none"><\/div>').appendTo("body");r.removeHandlers();r.addHandlers();r.loadSrc();r.preloadAsync();t.config.navHistory&&i.hasHash()&&setTimeout(r.handleHash)})},addHandlers:function(){n(document).on("click",t.select.methodOrRequest,this.handleRequest).on("change",t.select.methodWithChange,this.handleRequest).on("keydown",t.select.methodWithEnterOrModel,this.handleEnterKey).on("submit",t.select.formWithMethod,this.handleRequest).on("keydown",this.handleControlKey).on("keyup",this.handleControlKey).on(lojax.events.beforeRequest,this.disableButton).on(lojax.events.afterRequest,this.enableButton);t.config.navHistory&&window.addEventListener("hashchange",this.handleHash,!1)},removeHandlers:function(){n(document).off("click",this.handleRequest).off("change",this.handleRequest).off("keydown",this.handleEnterKey).off("submit",this.handleRequest).off("keydown",this.handleControlKey).off("keyup",this.handleControlKey).off(lojax.events.beforeRequest,this.disableButton).off(lojax.events.afterRequest,this.enableButton);t.config.navHistory&&window.removeEventListener("hashchange",this.handleHash,!1)},disableButton:function(n,t){t.eventType=="click"&&i.disable(t.source,30)},enableButton:function(n,t){i.enable(t.source)},handleRequest:function(u){var o,s,f,e;u.stopPropagation();o=i.getConfig(this);s=n(this);o.eventType=u.type;f=new t.Request(o);try{if(f.isNavHistory){if(r.isControl){i.enable(s);return}r.currentTransition=f.transition;e=f.action;f.data&&(e+="?"+f.data);"#"+e===window.location.hash?r.handleHash():window.location.hash=e}else r.executeRequest(f)}catch(h){i.enable(s);t.error(h)}u.preventDefault()},handleEnterKey:function(n){n.which===13&&r.handleRequest.call(this,n)},handleControlKey:function(n){n.which===17&&(r.isControl=n.type==="keydown")},handleHash:function(){if(t.config.navHistory){var f,u=window.location.hash;i.hasHash()?(f=n('a[name="'+u.substr(1)+'"]'),f.length===0&&r.executeRequest({action:u,method:"ajax-get",transition:r.currentTransition}),r.currentTransition=null):u===""&&t.emptyHashAction&&r.executeRequest(t.emptyHashAction)}},executeRequest:function(u){(u instanceof t.Request||(u=new t.Request(u)),u.action!==null)&&(u.action in this.cache?(u=this.cache[u.action],delete this.cache[u.action]):u.exec(),u.then(function(t){r.injectContent(u,t);r.handlePolling(u);i.enable(n(u.source))})["catch"](function(t){i.enable(n(u.source));typeof u.callbacks["catch"]!="function"&&r.handleError(t,u);r.handlePolling(u)}).then(u.callbacks.then,u.callbacks["catch"]))},injectContent:function(u,f){var a,h,v,e,y,c,l,o,s;if(r["in"]=null,l=function(f,e){e=e||document;var o=n(f);a=i.attr(o,"panel");h=u.target||n(e).find(t.select.panel(a)).first();h.length&&(v=i.resolveTransition(u,o),i.callOut(h),y=v(h,o),r.postInject(y,o,u))},u.target)l(n(f));else{if(o=n.parseHTML(f,!0),!o)return;for(s=0;s<o.length;s++){if(e=n(o[s]),c=document,i.triggerEvent(t.events.beforeInject,o,e),e.is(".modal"))if(r.modal!==null)c=r.modal;else{r.createModal(e,u);continue}u.target||e.is(i.attrSelector("panel"))?l(e,c):n(o[s]).find(i.attrSelector("panel")).each(function(){l(this,c)})}r.div.empty();o.forEach(function(t){e=n(t);e.is("script,style")&&r.div.append(e)})}},createModal:function(t,u){if(n.fn.modal){r.modal=n(t).appendTo("body").modal({show:!0,keyboard:!0});r.modal.on("hidden.bs.modal",function(){i.hasValue(r.modal)&&(r.modal.off("hidden.bs.modal",r.onModalClose),r.modal.modal("hide"),n(r.modal).remove(),r.modal=null)})}else if(n.fn.kendoWindow){r.modal=n(t).appendTo("body").kendoWindow({title:n(t).find(".dialog-header").text(),modal:!0,animation:{open:{effects:"fade:in"}},visible:!1,close:function(){i.hasValue(r.modal)&&(r.modal.data("kendoWindow").destroy(),n(r.modal).remove(),r.modal=null)}});r.modal.find(".modal-header").remove();r.modal.data("kendoWindow").center();r.modal.closest(".k-window").css({top:"20px",position:"fixed"});r.modal.data("kendoWindow").open();r.modal.one("click","[data-dismiss=modal]",function(){r.modal.data("kendoWindow").close()})}r.modal&&r.postInject(r.modal,t,u)},loadSrc:function(u){u=u||document;n(u).find(t.select.src).each(function(){var u=n(this),f=i.attr(u,"src"),t=i.getConfig(u);t.action=i.noCache(t.src);t.method=t.method||"ajax-get";t.target=u;t.transition=t.transition||"empty-append-node";t.suppressEvents=!0;r.executeRequest(t)})},preloadAsync:function(r){var e=this,f,u;r=r||document;setTimeout(function(){n(r).find(t.select.preload).each(function(){f=i.getConfig(this);f.method=f.method||"ajax-get";f.suppressEvents=!0;u=new t.Request(f);i.hasValue(u.action)&&!e.cache[u.action]&&(e.cache[u.action]=u,u.exec())})})},handlePolling:function(t){if(t.target&&n.isNumeric(t.poll)&&!(t.poll<=0)){var i=n(t.target)[0],u=i.ownerDocument.body.contains(i);u&&setTimeout(function(){r.executeRequest(t)},t.poll*1e3)}},postInject:function(u,f,e){typeof r.out=="function"&&(n(u)[0].out=r.out,r.out=null);i.triggerEvent(t.events.afterInject,u,f);i.callIn(u,e);i.hasValue(e)&&(u.refresh=e.exec.bind(e));r.loadSrc(u);r.preloadAsync(u)},handleError:function(n,r){(i.triggerEvent(t.events.ajaxError,n),n.handled)||n.status&&/^(4\d\d|5\d\d)/.test(n.status)&&/401|403|407/.test(n.status)==!1&&(r&&r.suppressEvents||alert("An error occurred while processing your request."),window.console&&window.console.error&&window.console.error(n))}}),function(n){if(!1 in n){var t="info";Object.defineProperty(n,"logging",{get:function(){return t},set:function(i){i===!0&&(i="info");t=i;i&&window.console!=undefined?(n.log=console.log.bind(console),n.info=/info/.test(i)&&console.info?console.info.bind(console):function(){},n.warn=/info|warn/.test(i)&&console.warn?console.warn.bind(console):function(){},n.debug=/info|warn|debug/.test(i)&&console.debug?console.debug.bind(console):function(){}):n.log=n.info=n.warn=n.debug=function(){}}})}n.logging="info";n.error=function(n){window.console!=undefined&&window.console.error!=undefined&&console.error(n)}}(t),n.extend(u,{search:/\?.+(?=#)|\?.+$/,hash:/#((.*)?[a-z]{2}\/[a-z]{2}(.*)?)/i,json:/^\{.*\}$|^\[.*\]$/,splitPath:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/,quoted:/^['"].+['"]$/}),n.extend(i,{afterRequest:function(n,r){r||i.triggerEvent(t.events.afterRequest,n)},attr:function(i,r){return n(i).attr("data-"+r)||n(i).attr(t.config.prefix+r)},attributes:"method action transition target form model preload src poll then catch".split(" "),attrSelector:function(n){return"[data-"+n+"],["+t.config.prefix+n+"]"},beforeRequest:function(n,r){r||i.triggerEvent(t.events.beforeRequest,n)},beforeSubmit:function(r){i.hasValue(r.source)&&n(r.source).is("[type=submit]")&&/post/.test(r.method)&&i.triggerEvent(t.events.beforeSubmit,r)},callIn:function(n,i){var u=r["in"];if(r["in"]=null,n&&u)try{u.call(n,i)}catch(f){t.error(f)}},callOut:function(n){if(n)if(typeof n[0].out=="function")n[0].out.call(n),n[0].out=null;else{var i=n.parent(t.select.src);i.length&&typeof i[0].out=="function"&&(i[0].out.call(i),i[0].out=null)}},callFunctionArray:function(n,i,r){Array.isArray(n)&&n.forEach(function(n){if(typeof n=="function")try{n.call(i,r)}catch(u){t.error(u)}})},disable:function(t,r){t=n(t);t.attr("disabled","disabled").addClass("disabled busy");typeof r=="number"&&r>0&&setTimeout(function(){i.enable(t)},r*1e3)},enable:function(t){t=t||n("[disabled].disabled.busy");t=n(t);t.removeAttr("disabled").removeClass("disabled busy")},formFromInputs:function(t,i,r){var u=n(t),f,e;return u.is("form")&&u.length==1&&(i==""||i==u.attr("action"))&&(r==""||r==u.attr("method"))?u:u.length?(i=i||window.location.href,r=r||"POST",f=n("<form method='"+r.toUpperCase()+"' action='"+i+"' style='display:none'><\/form>"),e=u.serializeArray(),e.forEach(function(t){n("<input type='hidden' />").appendTo(f).prop("name",t.name).val(t.value)}),f):t},formFromModel:function(t,r,u,f,e){var o,s,h;i.hasValue(e)||(r=r||"POST",u=u||window.location.href,e=n("<form method='"+r.toUpperCase()+"' action='"+u+"' style='display:none'><\/form>"),f="");o=n.type(t);switch(o){case"null":case"undefined":n("<input type='hidden' />").appendTo(e).prop("name",f);break;case"date":n("<input type='hidden' />").appendTo(e).prop("name",f).val(t.toISOString());break;case"array":t.forEach(function(n){i.formFromModel(n,r,u,f,e)});break;case"object":s=Object.getOwnPropertyNames(t);s.forEach(function(n){h=f===""?n:f+"."+n;i.formFromModel(t[n],r,u,h,e)});break;default:n("<input type='hidden' />").appendTo(e).prop("name",f).val(t.toString())}return e},getConfig:function(t){var r,u=n(t);return u.is(i.attrSelector("request"))?r=JSON.parse(i.attr(u,"request").replace(/'/g,'"')):(r={},i.attributes.forEach(function(n){var t=i.attr(u,n);t!==undefined&&(r[n]=t)})),r.source=t,r},getFunctionAtPath:function(n,t){var r,i,f;if(!n||typeof n=="function")return n;for(n=Array.isArray(n)?n:n.match(u.splitPath),n[0]==="window"&&(n=n.splice(1)),r=t||window,f=0;f<n.length;f++)if(i=n[f],u.indexer.test(i)?i=parseInt(/\d+/.exec(i)):u.quoted.test(i)&&(i=i.slice(1,-1)),r=r[i],r===undefined)return;return r},getModel:function(r){var f=n(r),u=f.data("model");if(!i.hasValue(u)&&n(r).is(t.select.jxModelAttribute)){if(u=f.attr(t.select.jxModel),!u)return null;u=i.isJSON(u)?JSON.parse(u):new t.Request({action:u,method:"ajax-get"});f.data("model",u)}return u},hasHash:function(n){return n=n||window.location.href,u.hash.test(n)},hasValue:function(n){return n!==undefined&&n!==null},isJSON:function(n){return u.json.test(n)},noCache:function(n){var r=(n.indexOf("?")!=-1?"&_=":"?_=")+i.nonce++,t=n.match(/\?.+(?=#)|\?.+$|.+(?=#)|.+/);return n.replace(t,t+r)},nonce:jQuery.now(),resolveAction:function(r){var u,f;return i.hasValue(r.action)&&r.action.length?u=r.action:i.hasValue(r.source)&&i.hasValue(r.source.href)&&r.source.href.length&&r.source.href.substr(0,11)!=="javascript:"?u=r.source.href:n(r.source).is("[type=submit]")?(f=n(r.source).closest("form,"+i.attrSelector("model")),f.is("form")&&(u=f.attr("action")||window.location.href)):n(r.source).is("form")&&(u=n(r.source).attr("action")||window.location.href),t.config.navHistory&&r.method==="ajax-get"&&i.hasHash(u)&&(u=i.resolveHash(u),r.isNavHistory=!0),u},resolveForm:function(r){var f,u;return i.hasValue(r.form)?(u=n(r.form),u.is("form")&&u.length==1)?u:u.find(":input").add(u.filter(":input")):n(r.source).is("[type=submit]")&&(f=n(r.source).closest("form,"+t.select.model),f.is("form"))?f:n(r.source).is("form")||n(r.source).is(t.select.inputTriggerChangeOrEnter)?r.source:null},resolveHash:function(n){return(n=n||window.location.href,i.hasHash(n))?n.substr(n.indexOf("#")+1):n},resolveModel:function(r){var f,u;return i.hasValue(r.model)?u=r.model:i.hasValue(r.source)&&n(r.source).is(t.select.model)?u=i.getModel(r.source):n(r.source).is("input[type=submit],button[type=submit]")&&(f=n(r.source).closest("form,"+t.select.model),f.is(t.select.model)&&(u=i.getModel(f))),typeof u=="string"&&u.length&&(u=i.isJSON(u)?JSON.parse(u):new t.Request({action:u,method:"ajax-get"})),r.source&&u&&n(r.source).data("model",u),u},resolvePoll:function(t){if(n.isNumeric(t.poll))return parseInt(t.poll)},resolveTarget:function(t){return i.hasValue(t.target)?n(t.target):null},resolveTransition:function(n,r){return n.transition?t.Transitions[n.transition]||t.Transitions[t.config.transition]:t.Transitions[i.attr(r,"transition")]||t.Transitions[t.config.transition]},standardDateFormat:function(n){if(!i.hasValue(n)||n=="")return n;if(typeof n=="string")return n.substring(0,10);var f=n.getFullYear(),r=n.getMonth()+1,u=n.getDate(),t=[];return t.push(f),t.push("-"),r<10&&t.push("0"),t.push(r),t.push("-"),u<10&&t.push("0"),t.push(u),t.join("")},triggerEvent:function(t,i,r){try{n.event.trigger({type:t,source:r||i},i)}catch(u){console&&console.error&&console.error(u)}}}),t.Request=function(n){typeof n=="function"&&(n=n());typeof n=="string"&&(n={action:n,method:"ajax-get"});this.method=n.method.toLowerCase();this.form=i.resolveForm(n);this.action=i.resolveAction(n);this.isNavHistory=n.isNavHistory;i.resolveModel&&(this.model=i.resolveModel(n));this.contentType="application/x-www-form-urlencoded; charset=UTF-8";this.transition=n.transition;this.target=i.resolveTarget(n);this.poll=i.resolvePoll(n);this.data=this.getData(n);this.source=n.source;this.preload="preload"in n;this.eventType=n.eventType;this.cancel=!1;this.resolve=[];this.reject=[];this.result=null;this.error=null;this.suppressEvents=n.suppressEvents||!1;this.callbacks={then:i.getFunctionAtPath(n.then),"catch":i.getFunctionAtPath(n["catch"])}},t.Request.prototype={getData:function(){var t;switch(this.method){case"get":case"ajax-get":case"ajax-delete":case"jsonp":this.model?t=i.formFromModel(this.model).serialize():this.form&&(t=i.formFromInputs(this.form,"","").serialize());break;case"post":t=this.model?i.formFromModel(this.model):this.form?i.formFromInputs(this.form,this.action,this.method):n("<form method='POST' action='"+this.action+"' style='display:none'><\/form>");break;case"ajax-post":case"ajax-put":this.model?(t=JSON.stringify(this.model),this.contentType="application/json"):this.form&&(t=i.formFromInputs(this.form,"","").serialize())}return t},getFullUrl:function(){switch(this.method){case"get":case"ajax-get":case"ajax-delete":case"jsonp":return this.action+(this.data?"?"+this.data:"");default:return this.action}},ajax:function(t){var i=this;n.ajax({url:this.action,type:t.toUpperCase(),data:this.data,contentType:this.contentType}).done(i.done.bind(i)).fail(i.fail.bind(i))},done:function(n){this.result=n;i.callFunctionArray(this.resolve,this,n);i.afterRequest(this,this.suppressEvents)},fail:function(n){this.error=n;i.callFunctionArray(this.reject,this,n);i.afterRequest(this,this.suppressEvents)},methods:{get:function(){window.location=this.getFullUrl();i.afterRequest(this,this.suppressEvents)},post:function(){var t=this,n=this.data;n.appendTo("body");n[0].submit();setTimeout(function(){n.remove();i.afterRequest(t,t.suppressEvents)},0)},"ajax-get":function(){n.get(this.action,this.data).done(this.done.bind(this)).fail(this.fail.bind(this))},"ajax-post":function(){this.ajax("post")},"ajax-put":function(){this.ajax("put")},"ajax-delete":function(){this.ajax("delete")},jsonp:function(){var t=this,n=document.createElement("script");n.type="text/javascript";n.src=this.getFullUrl();document.body.appendChild(n);setTimeout(function(){document.body.removeChild(n);i.afterRequest(t,t.suppressEvents)},10)}},exec:function(){if(this.reset(),!i.hasValue(this.methods[this.method]))throw"Unsupported method: "+this.method;if(i.hasValue(this.action)&&this.action!==""){if(i.beforeSubmit(this),this.cancel)return;i.beforeRequest(this,this.suppressEvents);this.cancel?i.afterRequest(this,this.suppressEvents):this.methods[this.method].bind(this)()}return this},then:function(n,t){return typeof n=="function"&&(this.resolve.push(n),this.result!==null&&n.call(this,this.result)),typeof t=="function"&&(this.reject.push(t),this.error!==null&&t.call(this,this.error)),this},"catch":function(n){return this.then(undefined,n)},reset:function(){this.cache||(this.result=null,this.error=null);this.cancel=!1;this.resolve=[];this.reject=[]}},n.extend(t.Transitions,{"empty-append-node":function(t,i){var r=n(t),u=n(i);return r.empty().append(u),r},"empty-append-children":function(t,i){var r=n(t),u=n(i);return r.empty().append(u.contents()),r},"append-node":function(t,i){var u=n(t),r=n(i);return u.append(r),r},"prepend-node":function(t,i){var u=n(t),r=n(i);return u.prepend(r),r},"fade-in":function(t,i){var r=n(t),u=n(i);return r.fadeOut(0).empty().append(u.contents()).fadeIn(),r},replace:function(t,i){var u=n(t),r=n(i);return u.replaceWith(r),r}}),t.bind=function(r,u){var f=n(r);return f.data("model",u),i.setElementsFromModel(f,u),f.is(t.select.model)||f.attr(t.select.jxModel,""),u},t.bindAllModels=function(n){f.bindToModels(null,n)},n.extend(u,{segments:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/}),f={init:function(){f.bindToModels();n(document).off("change",t.select.model,f.updateModel).off(t.events.afterInject,f.bindToModels);n(document).on("change",t.select.model,f.updateModel).on(t.events.afterInject,f.bindToModels)},bindToModels:function(r,u){u=u||document;var f,e=n(u).find(t.select.model).add(u).filter(t.select.model);e.each(function(){f=n(this);model=i.getModel(f);i.hasValue(model)&&model!==""?i.setElementsFromModel(f,model):model=i.buildModelFromElements(f);f.data("model",model)})},updateModel:function(r){var f=r.target.name;if(i.hasValue(f)&&f!=""){var u=n(this),o=n(r.target),s=i.getModel(u),h=u.find('[name="'+f+'"]'),e={target:r.target,name:f,value:o.val(),model:s,cancel:!1};(i.triggerEvent(t.events.beforeUpdateModel,e,u),e.cancel)||(i.setModelProperty(u,e.model,h),i.triggerEvent(t.events.afterUpdateModel,e,u),i.propagateChange(s,o))}}},n.extend(t.priv,{getPathSegments:function(n){return n.match(u.segments)},resolvePathSegment:function(n){return u.indexer.test(n)?parseInt(/\d+/.exec(n)):n},getObjectAtPath:function(n,t,r){for(var e=n,s,o=Array.isArray(t)?t:i.getPathSegments(t),f=0;f<o.length;f++){if(s=i.resolvePathSegment(o[f]),e[s]===undefined&&(e[s]=f<o.length-1&&u.indexer.test(o[f+1])?[]:f===o.length-1&&r?[]:f<o.length-1?{}:null),f===o.length-1&&(u.indexer.test(s)||Array.isArray(e[s])===!1))return e;e=e[s]}return e},setModelProperty:function(t,r,u){var f,o,h,e,s;s=i.getPathSegments(n(u).attr("name"));e=i.getValue(u);f=i.getObjectAtPath(r,s,Array.isArray(e));o=i.resolvePathSegment(s[s.length-1]);o in f?h=n.type(f[o]):Array.isArray(f)&&f.length&&(h=n.type(f[0]));e=i.castValues(e,h);Array.isArray(e)&&Array.isArray(f)?(f.splice(0,f.length),e.forEach(function(n){f.push(n)})):f[o]=e},buildModelFromElements:function(t){var u={},r={},f=n(t).find("[name]");return f.each(function(){var i=n(this).attr("name");i in r||(r[i]=n(t).find('[name="'+i+'"]'))}),Object.getOwnPropertyNames(r).forEach(function(n){i.setModelProperty(t,u,r[n])}),u},setElementsFromModel:function(t,r){var u,f,e,o=n(t);o.find("[name]").each(function(){e=this.name||n(this).attr("name");u=i.getModelValue(r,e);f=n.type(u);f==="date"&&this.type==="date"?n(this).val(i.standardDateFormat(u)):f==="boolean"&&this.type==="checkbox"?this.checked=u:this.type==="radio"?this.checked=this.value==u:this.value!==undefined?n(this).val(u):this.innerHTML!==undefined&&n(this).html(u==null?"":u.toString())})},getModelValue:function(n,t){var r,u=i.getPathSegments(t),f=i.resolvePathSegment(u[u.length-1]);try{return(r=i.getObjectAtPath(n,u),r[f]!==undefined)?r[f]:r}catch(e){console&&console.error&&(console.error("Could not resolve object path: "+t),console.error(e))}},getValue:function(n){if(n.length===0)return null;var t,i=n[0].type,r=n.length>1&&i!=="radio"&&n.filter('[type="'+i+'"]').length===n.length;return(i==="checkbox"?r?t=n.serializeArray().map(function(n){return n.value}):(t=n.val(),t=t.toLowerCase()=="true"?n[0].checked.toString():t.toLowerCase()=="false"?(!n[0].checked).toString():n[0].checked?t:null):t=i==="radio"?n.serializeArray()[0].value:r?n.serializeArray().map(function(n){return n.value}):n.val(),!r&&t==="")?null:t},castValues:function(t,i){var u=Array.isArray(t),r=u?t:[t];switch(i){case"number":r=r.filter(n.isNumeric).map(parseFloat);break;case"boolean":r=r.map(function(n){return n.toLowerCase()=="true"});break;case"null":case"undefined":r=r.map(function(n){return/true|false/i.test(n)?n.toLowerCase()==="true":n===""?null:n});break;default:r=r.map(function(n){return n===""?null:n})}return u?r:r[0]},propagateChange:function(r,u){var f=n(u),e=f.closest(t.select.model);n(document).find(t.select.model).not(e).each(function(){var t=n(this).data("model");t===r&&i.setElementsFromModel(this,r)})}}),n(f.init),t.Controller.init())})(jQuery,lojax);