"use strict";var lojax=lojax||{};(function(n,t){var i,u,r,e,f;t.Controller||(i={},u={},t.Controller={},t.Transitions={},r=t.Controller,t.priv=i,t.modules=[],t.on=function(t,i,u){if(u===undefined)n(document).on(t,function(){r.executeRequest(i)});else n(document).on(t,i,function(){r.executeRequest(u)})},t.off=function(t){n(document).off(t)},t.exec=function(n){r.executeRequest(n)},t["in"]=function(n){r["in"]=n},t.out=function(n){r.out=n},t.events={beforeSubmit:"beforeSubmit",beforeRequest:"beforeRequest",afterRequest:"afterRequest",beforeUpdateModel:"beforeUpdateModel",afterUpdateModel:"afterUpdateModel",beforeInject:"beforeInject",afterInject:"afterInject",ajaxError:"ajaxError"},Object.getOwnPropertyNames(t.events).forEach(function(i){t[i]=function(t){if(typeof t=="function")n(document).on(lojax.events[i],t)}}),t.config={prefix:"jx-",transition:"fade-in",emptyHashAction:null},e=!1,Object.defineProperty(t.config,"navHistory",{get:function(){return e},set:function(n){e=n;n?window.addEventListener("hashchange",t.Controller.handleHash,!1):window.removeEventListener("hashchange",t.Controller.handleHash,!1);n&&t.Controller.handleHash()}}),t.preload=function(n){var r,u;Array.isArray(n)||(n=[n]);n.forEach(function(n){r=typeof n=="string"?{action:n}:n;r.method=r.method||"ajax-get";r.suppressEvents=!0;u=new t.Request(r);i.hasValue(u.action)&&!t.Controller.cache[u.action]&&(t.Controller.cache[u.action]=u,u.exec())})},t.registerModule=function(n){typeof n=="function"&&t.modules.push(n)},t.select={methodOrRequest:"[data-request],[jx-request],[data-method]:not([data-trigger]),[jx-method]:not([jx-trigger])",methodWithChange:"[data-method][data-trigger*=change],[jx-method][jx-trigger*=change]",methodWithEnterOrModel:"[data-method][data-trigger*=enter],[jx-method][jx-trigger*=enter],[data-model],[jx-model]",formWithMethod:"form[data-method],form[jx-method]",model:"[data-model],[jx-model]",src:"[data-src],[jx-src]",preload:"[data-preload],[jx-preload]",jxModelAttribute:"[jx-model]",jxModel:"jx-model",inputTriggerChangeOrEnter:":input[name][jx-trigger*=change],:input[name][data-trigger*=change],:input[name][jx-trigger*=enter],:input[name][data-trigger*=enter]",panel:function(n){return"["+lojax.config.prefix+'panel="'+n+'"],[data-panel="'+n+'"]'}},n.extend(t.Controller,{init:function(){var r=this;this.div=null;this.modal=null;this.currentTransition=null;this.currentPanel=null;this.cache={};this.isControl=!1;n(function(){r.div=n('<div style="display:none"><\/div>').appendTo("body");r.removeHandlers();r.addHandlers();r.loadSrc();r.preloadAsync();t.config.navHistory&&i.hasHash()&&setTimeout(r.handleHash)})},addHandlers:function(){n(document).on("click",t.select.methodOrRequest,this.handleRequest).on("change",t.select.methodWithChange,this.handleRequest).on("keydown",t.select.methodWithEnterOrModel,this.handleEnterKey).on("submit",t.select.formWithMethod,this.handleRequest).on("keydown",this.handleControlKey).on("keyup",this.handleControlKey).on(lojax.events.beforeRequest,this.disableButton).on(lojax.events.afterRequest,this.enableButton);t.config.navHistory&&window.addEventListener("hashchange",this.handleHash,!1)},removeHandlers:function(){n(document).off("click",this.handleRequest).off("change",this.handleRequest).off("keydown",this.handleEnterKey).off("submit",this.handleRequest).off("keydown",this.handleControlKey).off("keyup",this.handleControlKey).off(lojax.events.beforeRequest,this.disableButton).off(lojax.events.afterRequest,this.enableButton);t.config.navHistory&&window.removeEventListener("hashchange",this.handleHash,!1)},disableButton:function(t,r){r.eventType=="click"&&(i.disable(r.source,30),n(r.source).addClass("busy"))},enableButton:function(n,t){i.enable(t.source)},handleRequest:function(u){var o,s,f,e;u.stopPropagation();o=i.getConfig(this);s=n(this);o.eventType=u.type;f=new t.Request(o);try{if(f.isNavHistory){if(r.isControl){i.enable(s);return}r.currentTransition=f.transition;e=f.action;f.data&&(e+="?"+f.data);"#"+e===window.location.hash?r.handleHash():window.location.hash=e}else r.executeRequest(f)}catch(h){i.enable(s);i.error(h)}u.preventDefault()},handleEnterKey:function(n){n.which===13&&r.handleRequest.call(this,n)},handleControlKey:function(n){n.which===17&&(r.isControl=n.type==="keydown")},handleHash:function(){var f,u=window.location.hash;t.config.navHistory&&(i.hasHash()?(f=n('a[name="'+u.substr(1)+'"]'),f.length===0&&r.executeRequest({action:u,method:"ajax-get",transition:r.currentTransition}),r.currentTransition=null):u===""&&t.emptyHashAction&&r.executeRequest(t.emptyHashAction))},executeRequest:function(u){var f,e;(u instanceof t.Request||(u=new t.Request(u)),u.action!==null)&&(u.action in this.cache?(f=this.cache[u.action],e="isNavHistory transition source before callbacks suppressEvents eventType".split(" "),e.forEach(function(n){f[n]=f[n]||u[n]}),delete this.cache[f.action]):(f=u,f.source&&n(f.source).is(":button,a")&&i.disable(f.source,30),u.exec()),f.then(function(t){r.injectContent(f,t);r.handlePolling(f);i.enable(n(f.source))})["catch"](function(t){i.enable(n(f.source));typeof f.callbacks["catch"]!="function"&&r.handleError(t,f);r.handlePolling(f)}).then(f.callbacks.then,f.callbacks["catch"]))},injectContent:function(u,f){var a,h,v,e,y,l,p,c,o,s;if(r["in"]=null,c=function(f,e){e=e||document;var o=n(f);a=i.attr(o,"panel");h=u.target||n(e).find(t.select.panel(a)).first();h.length&&(v=i.resolveTransition(u,o),i.callOut(h),y=v(h,o),r.postInject(y,o,u))},u.target)c(n(f));else{if(o=n.parseHTML(f,!0),!o)return;for(s=0;s<o.length;s++)(e=n(o[s]),l=document,i.triggerEvent(t.events.beforeInject,o,e),p=this.checkForModule(e,u),p)||(u.target||e.is(i.attrSelector("panel"))?c(e,l):n(o[s]).find(i.attrSelector("panel")).each(function(){c(this,l)}));r.div.empty();o.forEach(function(t){e=n(t);e.is("script,style")&&r.div.append(e)})}},checkForModule:function(n,i){for(var r=0;r<t.modules.length;r++)if(t.modules[r](n,i))return!0;return!1},loadSrc:function(u){u=u||document;n(u).find(t.select.src).each(function(){var u=n(this),f=i.attr(u,"src"),t=i.getConfig(u);t.action=i.noCache(t.src);t.method=t.method||"ajax-get";t.target=u;t.transition=t.transition||"empty-append-node";t.suppressEvents=!0;r.executeRequest(t)})},preloadAsync:function(r){setTimeout(function(){var u,f=[];r=r||document;n(r).find(t.select.preload).each(function(){u=i.getConfig(this);u.method=u.method||"ajax-get";u.suppressEvents=!0;f.push(u)});f.length&&t.preload(f)})},handlePolling:function(t){if(t.target&&n.isNumeric(t.poll)&&!(t.poll<=0)){var i=n(t.target)[0],u=i.ownerDocument.body.contains(i);u&&setTimeout(function(){r.executeRequest(t)},t.poll*1e3)}},postInject:function(u,f,e){typeof r.out=="function"&&(n(u)[0].out=r.out,r.out=null);i.triggerEvent(t.events.afterInject,u,f);i.callIn(u,e);i.hasValue(e)&&(u.refresh=e.exec.bind(e));r.loadSrc(u);r.preloadAsync(u)},handleError:function(n,r){(i.triggerEvent(t.events.ajaxError,n),n.handled)||n.status&&/^(4\d\d|5\d\d)/.test(n.status)&&/401|403|407/.test(n.status)==!1&&(r&&r.suppressEvents||alert("An error occurred while processing your request."),i.error(n))}}),n.extend(u,{search:/\?.+(?=#)|\?.+$/,hash:/#((.*)?[a-z]{2}\/[a-z]{2}(.*)?)/i,json:/^\{.*\}$|^\[.*\]$/,splitPath:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/,quoted:/^['"].+['"]$/}),n.extend(i,{afterRequest:function(n,r){r||i.triggerEvent(t.events.afterRequest,n)},attr:function(i,r){return n(i).attr("data-"+r)||n(i).attr(t.config.prefix+r)},attributes:"method action transition target form model preload src poll then catch".split(" "),attrSelector:function(n){return"[data-"+n+"],["+t.config.prefix+n+"]"},beforeRequest:function(n,r){r||i.triggerEvent(t.events.beforeRequest,n)},beforeSubmit:function(r){i.hasValue(r.source)&&n(r.source).is("[type=submit]")&&/post/.test(r.method)&&i.triggerEvent(t.events.beforeSubmit,r)},call:function(n,i,r){try{n.call(i,r)}catch(u){t.priv.error(u)}},callIn:function(n,t){var u=r["in"];r["in"]=null;n&&u&&i.call(u,n,t)},callOut:function(n){if(n)if(typeof n[0].out=="function")i.call(n[0].out,n),n[0].out=null;else{var r=n.parent(t.select.src);r.length&&typeof r[0].out=="function"&&(i.call(r[0].out,r),r[0].out=null)}},callFunctionArray:function(n,t,r){Array.isArray(n)&&n.forEach(function(n){typeof n=="function"&&i.call(n,t,r)})},disable:function(t,r){t&&(n(t).attr("disabled","disabled").addClass("disabled"),typeof r=="number"&&r>0&&setTimeout(function(){i.enable(t)},r*1e3))},enable:function(t){n(t).removeAttr("disabled").removeClass("disabled busy")},error:function(n){window.console!=undefined&&window.console.error!=undefined&&console.error(n)},formFromInputs:function(t,i,r){var u=n(t),f,e;return u.is("form")&&u.length==1&&(i==""||i==u.attr("action"))&&(r==""||r==u.attr("method"))?u:u.length?(i=i||window.location.href,r=r||"POST",f=n("<form method='"+r.toUpperCase()+"' action='"+i+"' style='display:none'><\/form>"),e=u.serializeArray(),e.forEach(function(t){n("<input type='hidden' />").appendTo(f).prop("name",t.name).val(t.value)}),f):t},formFromModel:function(t,r,u,f,e){var o,s,h;i.hasValue(e)||(r=r||"POST",u=u||window.location.href,e=n("<form method='"+r.toUpperCase()+"' action='"+u+"' style='display:none'><\/form>"),f="");o=n.type(t);switch(o){case"null":case"undefined":n("<input type='hidden' />").appendTo(e).prop("name",f);break;case"date":n("<input type='hidden' />").appendTo(e).prop("name",f).val(t.toISOString());break;case"array":t.forEach(function(n){i.formFromModel(n,r,u,f,e)});break;case"object":s=Object.getOwnPropertyNames(t);s.forEach(function(n){h=f===""?n:f+"."+n;i.formFromModel(t[n],r,u,h,e)});break;default:n("<input type='hidden' />").appendTo(e).prop("name",f).val(t.toString())}return e},getConfig:function(t){var r,u=n(t);return u.is(i.attrSelector("request"))?r=JSON.parse(i.attr(u,"request").replace(/'/g,'"')):(r={},i.attributes.forEach(function(n){var t=i.attr(u,n);t!==undefined&&(r[n]=t)})),r.source=t,r},getFormData:function(t){var i=new FormData;return n(t).serializeArray().forEach(function(n){i.append(n.name,n.value)}),n(t).find("[type=file]").each(function(){this.files.length&&i.append(this.name,this.files[0])}),i},getFunctionAtPath:function(n,t){var r,i,f;if(!n||typeof n=="function")return n;for(n=Array.isArray(n)?n:n.match(u.splitPath),n[0]==="window"&&(n=n.splice(1)),r=t||window,f=0;f<n.length;f++)if(i=n[f],u.indexer.test(i)?i=parseInt(/\d+/.exec(i)):u.quoted.test(i)&&(i=i.slice(1,-1)),r=r[i],r===undefined)return;return r},getModel:function(r){var f=n(r),u=f.data("model");if(!i.hasValue(u)&&n(r).is(t.select.jxModelAttribute)){if(u=f.attr(t.select.jxModel),!u)return null;u=i.isJSON(u)?JSON.parse(u):new t.Request({action:u,method:"ajax-get"});f.data("model",u)}return u},hasHash:function(n){return n=n||window.location.href,u.hash.test(n)},hasValue:function(n){return n!==undefined&&n!==null},isJSON:function(n){return u.json.test(n)},noCache:function(n){var r=(n.indexOf("?")!=-1?"&_=":"?_=")+i.nonce++,t=n.match(/\?.+(?=#)|\?.+$|.+(?=#)|.+/);return n.replace(t,t+r)},nonce:jQuery.now(),resolveAction:function(r){var u,f;return i.hasValue(r.action)&&r.action.length?u=r.action:i.hasValue(r.source)&&i.hasValue(r.source.href)&&r.source.href.length&&r.source.href.substr(0,11)!=="javascript:"?u=r.source.href:n(r.source).is("[type=submit]")?(f=n(r.source).closest("form,"+i.attrSelector("model")),f.is("form")&&(u=f.attr("action")||window.location.href)):n(r.source).is("form")?u=n(r.source).attr("action")||window.location.href:n(r.form).is("form[action]")&&(u=n(r.form).attr("action")||window.location.href),t.config.navHistory&&r.method==="ajax-get"&&i.hasHash(u)&&(u=i.resolveHash(u),r.isNavHistory=!0),u},resolveForm:function(r){var f,u;return i.hasValue(r.form)?(u=n(r.form),u.is("form")&&u.length==1)?u:u.find(":input").add(u.filter(":input")):n(r.source).is("[type=submit]")&&(f=n(r.source).closest("form,"+t.select.model),f.is("form"))?f:n(r.source).is("form")||n(r.source).is(t.select.inputTriggerChangeOrEnter)?r.source:null},resolveHash:function(n){return(n=n||window.location.href,i.hasHash(n))?n.substr(n.indexOf("#")+1):n},resolveModel:function(r){var f,u;return i.hasValue(r.model)?u=r.model:i.hasValue(r.source)&&n(r.source).is(t.select.model)?u=i.getModel(r.source):n(r.source).is("input[type=submit],button[type=submit]")&&(f=n(r.source).closest("form,"+t.select.model),f.is(t.select.model)&&(u=i.getModel(f))),typeof u=="string"&&u.length&&(u=i.isJSON(u)?JSON.parse(u):new t.Request({action:u,method:"ajax-get"})),r.source&&u&&n(r.source).data("model",u),u},resolvePoll:function(t){if(n.isNumeric(t.poll))return parseInt(t.poll)},resolveTarget:function(t){return i.hasValue(t.target)?n(t.target):null},resolveTransition:function(n,r){return n.transition?t.Transitions[n.transition]||t.Transitions[t.config.transition]:t.Transitions[i.attr(r,"transition")]||t.Transitions[t.config.transition]},standardDateFormat:function(n){if(!i.hasValue(n)||n=="")return n;if(typeof n=="string")return n.substring(0,10);var t=n.getMonth()+1,r=n.getDate();return[n.getFullYear(),("0"+t).slice(-2),("0"+r).slice(-2)].join("-")},triggerEvent:function(t,r,u){try{n.event.trigger({type:t,source:u||r},r)}catch(f){i.error(f)}}}),t.Request=function(n){typeof n=="function"&&(n=n());typeof n=="string"&&(n={action:n,method:"ajax-get"});this.method=n.method.toLowerCase();this.form=i.resolveForm(n);this.action=i.resolveAction(n);this.isNavHistory=n.isNavHistory;this.model=i.resolveModel(n);this.contentType=n.contentType||"application/x-www-form-urlencoded; charset=UTF-8";this.transition=n.transition;this.target=i.resolveTarget(n);this.poll=i.resolvePoll(n);this.processData=!0;this.data=this.getData(n);this.source=n.source;this.preload="preload"in n;this.eventType=n.eventType;this.cancel=!1;this.resolve=[];this.reject=[];this.result=n.result||null;this.error=n.rerror||null;this.suppressEvents=n.suppressEvents||!1;this.callbacks={then:i.getFunctionAtPath(n.then),"catch":i.getFunctionAtPath(n["catch"])};this.before=i.getFunctionAtPath(n.before)},t.Request.prototype={getData:function(){switch(this.method){case"get":case"ajax-get":case"ajax-delete":case"jsonp":if(this.model)return i.formFromModel(this.model).serialize();if(this.form)return n(this.form).serialize();break;case"post":case"put":return this.model?i.formFromModel(this.model):this.form?i.formFromInputs(this.form,this.action,this.method):n("<form method='"+this.method.toUpperCase()+"' action='"+this.action+"' style='display:none'><\/form>");case"ajax-post":case"ajax-put":if(this.model)return JSON.stringify(this.model);if(this.form)return window.FormData?(this.processData=!1,this.contentType=!1,i.getFormData(this.form)):n(this.form).serialize()}return null},getFullUrl:function(){return/^(get|ajax-get|ajax-delete|jsonp)$/.test(this.method)?this.action+(this.data?"?"+this.data:""):this.action},ajax:function(t){var i=this;n.ajax({url:this.action,type:t,data:this.data,contentType:this.contentType,processData:this.processData}).done(i.done.bind(i)).fail(i.fail.bind(i))},done:function(n){this.result=n;i.callFunctionArray(this.resolve,this,n);i.afterRequest(this,this.suppressEvents)},fail:function(n){this.error=n;i.callFunctionArray(this.reject,this,n);i.afterRequest(this,this.suppressEvents)},methods:{get:function(){window.location=this.getFullUrl();i.afterRequest(this,this.suppressEvents)},post:function(){var t=this,n=this.data;n.appendTo("body");n[0].submit();setTimeout(function(){n.remove();i.afterRequest(t,t.suppressEvents)},0)},put:function(){var t=this,n=this.data;n.appendTo("body");n[0].submit();setTimeout(function(){n.remove();i.afterRequest(t,t.suppressEvents)},0)},"ajax-get":function(){n.get(this.action,this.data).done(this.done.bind(this)).fail(this.fail.bind(this))},"ajax-post":function(){this.ajax("POST")},"ajax-put":function(){this.ajax("PUT")},"ajax-delete":function(){this.ajax("DELETE")},jsonp:function(){var t=this,n=document.createElement("script");n.type="text/javascript";n.src=this.getFullUrl();document.body.appendChild(n);setTimeout(function(){document.body.removeChild(n);i.afterRequest(t,t.suppressEvents)},10)}},exec:function(){if(this.reset(),!i.hasValue(this.methods[this.method]))throw"Unsupported method: "+this.method;if(i.hasValue(this.action)&&this.action!==""){if(typeof this.before=="function"&&(i.call(this.before,this,this),this.cancel))return;if(i.beforeSubmit(this),this.cancel)return;i.beforeRequest(this,this.suppressEvents);this.cancel?i.afterRequest(this,this.suppressEvents):this.methods[this.method].bind(this)()}return this},then:function(n,t){return typeof n=="function"&&(this.resolve.push(n),this.result!==null&&i.call(n,this,this.result)),typeof t=="function"&&(this.reject.push(t),this.error!==null&&i.call(t,this,this.error)),this},"catch":function(n){return this.then(undefined,n)},reset:function(){this.result=null;this.error=null;this.cancel=!1;this.resolve=[];this.reject=[]}},n.extend(t.Transitions,{"empty-append-node":function(t,i){var r=n(t),u=n(i);return r.empty().append(u),r},"empty-append-children":function(t,i){var r=n(t),u=n(i);return r.empty().append(u.contents()),r},"append-node":function(t,i){var u=n(t),r=n(i);return u.append(r),r},"prepend-node":function(t,i){var u=n(t),r=n(i);return u.prepend(r),r},"fade-in":function(t,i){var r=n(t),u=n(i);return r.fadeOut(0).empty().append(u.contents()).fadeIn(),r},replace:function(t,i){var u=n(t),r=n(i);return u.replaceWith(r),r}}),function(){var u=null,f={canHandle:function(t,i){return n.fn.modal&&t.is(".modal")&&u==null?(f.createModal(t,i),!0):!1},createModal:function(t){u=n(t).appendTo("body").modal({show:!0,keyboard:!0});u.one("hidden.bs.modal",function(){i.hasValue(u)&&(n(u).remove(),u=null)});lojax.Controller.postInject(u,t,request)}};t.createModal=function(f){t.closeModal();u=n(f).modal({show:!0,keyboard:!0});u.on("hidden.bs.modal",function(){i.hasValue(u)&&(u.off("hidden.bs.modal",r.onModalClose),u=null)})};t.closeModal=function(t){if(i.hasValue(u)&&n.fn.modal){if(typeof t=="function")u.one("hidden.bs.modal",t);u.modal("hide")}};t.registerModule(f.canHandle)}(),t.bind=function(r,u){var f=n(r);return f.data("model",u),i.setElementsFromModel(f,u),f.is(t.select.model)||f.attr(t.select.jxModel,""),u},t.bindAllModels=function(n){f.bindToModels(null,n)},n.extend(u,{segments:/[^\[\]\.\s]+|\[\d+\]/g,indexer:/\[\d+\]/}),f={init:function(){f.bindToModels();n(document).off("change",t.select.model,f.updateModel).off(t.events.afterInject,f.bindToModels);n(document).on("change",t.select.model,f.updateModel).on(t.events.afterInject,f.bindToModels)},bindToModels:function(r,u){u=u||document;var e,f,o=n(u).find(t.select.model).add(u).filter(t.select.model);o.each(function(){e=n(this);f=i.getModel(e);i.hasValue(f)&&f!==""?i.setElementsFromModel(e,f):f=i.buildModelFromElements(e);e.data("model",f)})},updateModel:function(r){var f=r.target.name;if(i.hasValue(f)&&f!=""){var u=n(this),o=n(r.target),s=i.getModel(u),h=u.find('[name="'+f+'"]'),e={target:r.target,name:f,value:o.val(),model:s,cancel:!1};(i.triggerEvent(t.events.beforeUpdateModel,e,u),e.cancel)||(i.setModelProperty(u,e.model,h),i.triggerEvent(t.events.afterUpdateModel,e,u),i.propagateChange(s,o))}}},n.extend(t.priv,{getPathSegments:function(n){return n.match(u.segments)},resolvePathSegment:function(n){return u.indexer.test(n)?parseInt(/\d+/.exec(n)):n},getObjectAtPath:function(n,t,r){for(var e=n,s,o=Array.isArray(t)?t:i.getPathSegments(t),f=0;f<o.length;f++){if(s=i.resolvePathSegment(o[f]),e[s]===undefined&&(e[s]=f<o.length-1&&u.indexer.test(o[f+1])?[]:f===o.length-1&&r?[]:f<o.length-1?{}:null),f===o.length-1&&(u.indexer.test(s)||Array.isArray(e[s])===!1))return e;e=e[s]}return e},setModelProperty:function(t,r,u){var f,o,h,e,s;s=i.getPathSegments(n(u).attr("name"));e=i.getValue(u);f=i.getObjectAtPath(r,s,Array.isArray(e));o=i.resolvePathSegment(s[s.length-1]);o in f?h=n.type(f[o]):Array.isArray(f)&&f.length&&(h=n.type(f[0]));e=i.castValues(e,h);Array.isArray(e)&&Array.isArray(f)?(f.splice(0,f.length),e.forEach(function(n){f.push(n)})):f[o]=e},buildModelFromElements:function(t){var u={},r={},f=n(t).find("[name]");return f.each(function(){var i=n(this).attr("name");i in r||(r[i]=n(t).find('[name="'+i+'"]'))}),Object.getOwnPropertyNames(r).forEach(function(n){i.setModelProperty(t,u,r[n])}),u},setElementsFromModel:function(t,r){var u,f,e,o=n(t);o.find("[name]").each(function(){e=this.name||n(this).attr("name");u=i.getModelValue(r,e);f=n.type(u);f==="date"&&this.type==="date"?n(this).val(i.standardDateFormat(u)):f==="boolean"&&this.type==="checkbox"?this.checked=u:this.type==="radio"?this.checked=this.value==u:this.value!==undefined?n(this).val(u):this.innerHTML!==undefined&&n(this).html(u==null?"":u.toString())})},getModelValue:function(n,t){var r,u=i.getPathSegments(t),f=i.resolvePathSegment(u[u.length-1]);try{return(r=i.getObjectAtPath(n,u),r[f]!==undefined)?r[f]:r}catch(e){i.error("Could not resolve object path: "+t);i.error(e)}},getValue:function(n){if(n.length===0)return null;var t,i=n[0].type,r=n.length>1&&i!=="radio"&&n.filter('[type="'+i+'"]').length===n.length;return(i==="checkbox"?r?t=n.serializeArray().map(function(n){return n.value}):(t=n.val(),t=t.toLowerCase()=="true"?n[0].checked.toString():t.toLowerCase()=="false"?(!n[0].checked).toString():n[0].checked?t:null):t=i==="radio"?n.serializeArray()[0].value:r?n.serializeArray().map(function(n){return n.value}):n.val(),!r&&t==="")?null:t},castValues:function(t,i){var u=Array.isArray(t),r=u?t:[t];switch(i){case"number":r=r.filter(n.isNumeric).map(parseFloat);break;case"boolean":r=r.map(function(n){return n.toLowerCase()=="true"});break;case"null":case"undefined":r=r.map(function(n){return/true|false/i.test(n)?n.toLowerCase()==="true":n===""?null:n});break;default:r=r.map(function(n){return n===""?null:n})}return u?r:r[0]},propagateChange:function(r,u){var f=n(u),e=f.closest(t.select.model);n(document).find(t.select.model).not(e).each(function(){var t=n(this).data("model");t===r&&i.setElementsFromModel(this,r)})}}),n(f.init),t.Controller.init())})(jQuery,lojax);